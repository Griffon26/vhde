language: cpp
dist: trusty
sudo: true

env:
  - PKG_CONFIG_PATH=${HOME}/.local/share/pkgconfig:${HOME}/.local/lib/pkgconfig/ ACLOCAL_PATH="${HOME}/.local/share/aclocal"

addons:
  apt:
    sources:
       #- george-edison55-precise-backports # cmake 3.2.2
       #- ubuntu-toolchain-r-test # g++-5
    packages:
       - cmake
       - g++-5
       - gtk-doc-tools
       - libclutter-1.0-dev
       - libgtkmm-3.0-dev
       - libxml-parser-perl
       - mm-common
       - uuid-dev

compiler:
  - gcc
  - clang

before_script:
  - export CC="gcc-5"
  - export CXX="g++-5"
  - export CXXFLAGS="-Wno-deprecated-declarations"
  - ./install-from-github.sh GNOME cluttermm 1.3.2 -p cluttermm-1.3.2-cairo-texture-namespace-fix.patch
  - ./install-from-github.sh GNOME clutter-gtk 1.5.2
  - ./install-from-github.sh GNOME clutter-gtkmm CLUTTER_GTKMM_0_91_8

script:
  - cmake .
  - make
